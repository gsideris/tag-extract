$.fn.extend({tagExtract:function(e){var t,n;return n=$.fn.tagExtract,t=$.extend({},n.default_options,e),$(this).each(function(e,o){return n.init(o,t)})}}),$.extend($.fn.tagExtract,{default_options:{ignored:["the","be","to","of","and","a","in","that","have","I","it","for","not","on","with","he","as","you","do","at","this","but","his","by","from","they","we","say","her","she","or","an","will","my","one","all","would","there","their","what","so","up","out","if","about","who","get","which","go","me","when","make","can","like","time","no","just","him","know","take","person","into","year","your","good","some","could","them","see","other","than","then","now","look","only","come","its","over","think","also","back","after","use","two","how","our","work","first","well","way","even","new","want","because","any","these","give","day","most","us","were","was","has","less","more","is","s","said","between","without","are","been","such","did","both","had","still","within"]},init:function(e,t){var n,o,a,r,s,h,i,l,u,f,c,w,d,g,p,b,y,m,k,v,x,j,E,O,I,M,_,A,C,F,G,L,R,S,T,W,q,z,B,D,H,J,K,N,P,Q;for(u=t.ignored,M=$(e).text(),s=t.clusters,r=s.length,I=t.max,F=0,S=u.length;S>F;F++)C=u[F],j=new RegExp("\\b"+C+"\\b","gi"),M=M.replace(j,"");for(y=0,v=[],J=M.split("\n"),G=0,T=J.length;T>G;G++)for(w=J[G],K=w.split(/\W+/),L=0,W=K.length;W>L;L++)_=K[L],C="#"+_.toLowerCase(),!parseFloat(C)&&C.length>1&&(y+=1,v[C]?v[C]=parseInt(v[C]+1):v[C]=1);O=0;for(f in v)A=v[f],v[f]=v[f]/y,O+=v[f];for(n=O/y,v=function(e){var t,o,a,r;for(o={},t=Object.keys(e).sort(function(t,n){return e[n]-e[t]}),a=0,r=t.length;r>a;a++)f=t[a],e[f]>n&&(o[f]=e[f]);return o}(v),d=-1,g=1e3,x=Object.keys(v).slice(0,+I+1||9e9),i={},R=0,q=x.length;q>R;R++)m=x[R],g>100*v[m]&&(g=100*v[m]),d<100*v[m]&&(d=100*v[m]),i[m]=100*v[m];for(h=d-g,a=h/r,o=[],l=B=0,N=r-1;N>=0?N>=B:B>=N;l=N>=0?++B:--B)o[g+l*a]=[];for(P=Object.keys(i),D=0,z=P.length;z>D;D++){for(f=P[D],E=i[f],b=1e3,p=0,l=H=0,Q=r-1;Q>=0?Q>=H:H>=Q;l=Q>=0?++H:--H)c=g+l*a,Math.abs(c-E)<b&&(b=Math.abs(c-E),p=c);o[p].push(f)}return k=$(e).find(".tags-extracted").each(function(e,t){var n,a,r,h,i,l,u,c,w;for(a=0,$(t).empty(),$(t).append("TAGS:"),c=Object.keys(o).reverse(),w=[],u=0,l=c.length;l>u;u++)f=c[u],n=o[f],r=s[a],a+=1,w.push(function(){var e,o,a;for(a=[],o=0,e=n.length;e>o;o++)i=n[o],h=$("<span>").attr({"class":"label "+r}).append(i),a.push($(t).append(h));return a}());return w})}});
