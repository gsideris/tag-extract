$.fn.extend({tagExtract:function(a){var b,c;return c=$.fn.tagExtract,b=$.extend({},c.default_options,a),$(this).each(function(a,d){return c.init(d,b)})}}),$.extend($.fn.tagExtract,{default_options:{max:"auto",min:3,ignored:["the","be","to","of","and","a","in","that","have","I","it","for","not","on","with","he","as","you","do","at","this","but","his","by","from","they","we","say","her","she","or","an","will","my","one","all","would","there","their","what","so","up","out","if","about","who","get","which","go","me","when","make","can","like","time","no","just","him","know","take","person","into","year","your","good","some","could","them","see","other","than","then","now","look","only","come","its","over","think","also","back","after","use","two","how","our","work","first","well","way","even","new","want","because","any","these","give","day","most","us","were","was","has","less","more","is","s","said","between","without","are","been","such","did","both","had","still","within"]},init:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W;for(k=b.ignored,B=b.target,C=$(a).is("textarea")?$(a).val():$(a).text(),g=b.clusters,f=g.length,A=b.max,G=0,K=k.length;G<K;G++)F=k[G],x=new RegExp("\\b"+F+"\\b","gi"),C=C.replace(x,"");for(s=0,v=[],S=C.split("\n"),H=0,L=S.length;H<L;H++)for(n=S[H],T=n.split(/\W+/),I=0,M=T.length;I<M;I++)D=T[I],F="#"+D.toLowerCase(),!parseFloat(F)&&F.length>1&&(s+=1,v[F]?v[F]=parseInt(v[F]+1):v[F]=1);z=0;for(l in v)E=v[l],v[l]=v[l]/s,z+=v[l];for(c=z/s,"auto"===A&&(A=Math.floor(s/10),A<b.min&&(A=b.min)),v=function(a){var b,d,e,f;for(d={},b=Object.keys(a).sort(function(b,c){return a[c]-a[b]}),e=0,f=b.length;e<f;e++)l=b[e],a[l]>c&&(d[l]=a[l]);return d}(v),o=-1,p=1e3,w=Object.keys(v).slice(0,+A+1||9e9),i={},J=0,N=w.length;J<N;J++)t=w[J],p>100*v[t]&&(p=100*v[t]),o<100*v[t]&&(o=100*v[t]),i[t]=100*v[t];for(h=o-p,e=h/f,d=[],j=P=0,U=f-1;0<=U?P<=U:P>=U;j=0<=U?++P:--P)d[p+j*e]=[];for(V=Object.keys(i),Q=0,O=V.length;Q<O;Q++){for(l=V[Q],y=i[l],r=1e3,q=0,j=R=0,W=f-1;0<=W?R<=W:R>=W;j=0<=W?++R:--R)m=p+j*e,Math.abs(m-y)<r&&(r=Math.abs(m-y),q=m);d[q].push(l)}return u=$("#"+B).each(function(a,b){var c,e,f,h,i,j,k,m,n;for(e=0,$(b).empty(),m=Object.keys(d).reverse(),n=[],k=0,j=m.length;k<j;k++)l=m[k],c=d[l],f=g[e],e+=1,n.push(function(){var a,d,e;for(e=[],d=0,a=c.length;d<a;d++)i=c[d],h=$("<span>").attr({class:"label "+f}).append(i),e.push($(b).append(h));return e}());return n})}});
