$.fn.extend({tagExtract:function(e){var t,n;return n=$.fn.tagExtract,t=$.extend({},n.default_options,e),$(this).each(function(e,r){return n.init(r,t)})}}),$.extend($.fn.tagExtract,{default_options:{max:"auto",min:3,ignored:["the","be","to","of","and","a","in","that","have","I","it","for","not","on","with","he","as","you","do","at","this","but","his","by","from","they","we","say","her","she","or","an","will","my","one","all","would","there","their","what","so","up","out","if","about","who","get","which","go","me","when","make","can","like","time","no","just","him","know","take","person","into","year","your","good","some","could","them","see","other","than","then","now","look","only","come","its","over","think","also","back","after","use","two","how","our","work","first","well","way","even","new","want","because","any","these","give","day","most","us","were","was","has","less","more","is","s","said","between","without","are","been","such","did","both","had","still","within"]},init:function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,J,K;l=t.ignored,k=t.target,$(e).is("textarea")?L=$(e).val():L=$(e).text(),o=t.clusters,s=o.length,C=t.max;for(_=0,B=l.length;_<B;_++)M=l[_],x=new RegExp("\\b"+M+"\\b","gi"),L=L.replace(x,"");y=0,E=[],W=L.split("\n");for(D=0,j=W.length;D<j;D++){p=W[D],X=p.split(/\W+/);for(P=0,F=X.length;P<F;P++)A=X[P],M="#"+A.toLowerCase(),!parseFloat(M)&&M.length>1&&(y+=1,E[M]?E[M]=parseInt(E[M]+1):E[M]=1)}N=0;for(c in E)O=E[c],E[c]=E[c]/y,N+=E[c];n=N/y,C==="auto"&&(C=Math.floor(y/100),C<t.min&&(C=t.min)),E=function(e){var t,r,i,s;r={},t=Object.keys(e).sort(function(t,n){return e[n]-e[t]});for(i=0,s=t.length;i<s;i++)c=t[i],e[c]>n&&(r[c]=e[c]);return r}(E),d=-1,v=1e3,S=Object.keys(E).slice(0,+C+1||9e9),a={};for(H=0,I=S.length;H<I;H++)b=S[H],v>E[b]*100&&(v=E[b]*100),d<E[b]*100&&(d=E[b]*100),a[b]=E[b]*100;u=d-v,i=u/s,r=[];for(f=R=0,V=s-1;0<=V?R<=V:R>=V;f=0<=V?++R:--R)r[v+f*i]=[];J=Object.keys(a);for(U=0,q=J.length;U<q;U++){c=J[U],T=a[c],g=1e3,m=0;for(f=z=0,K=s-1;0<=K?z<=K:z>=K;f=0<=K?++z:--z)h=v+f*i,Math.abs(h-T)<g&&(g=Math.abs(h-T),m=h);r[m].push(c)}return w=$("#"+k).each(function(e,t){var n,i,s,u,a,f,l,h,p;i=0,$(t).empty(),h=Object.keys(r).reverse(),p=[];for(l=0,f=h.length;l<f;l++)c=h[l],n=r[c],s=o[i],i+=1,p.push(function(){var e,r,i;i=[];for(r=0,e=n.length;r<e;r++)a=n[r],u=$("<span>").attr({"class":"label "+s}).append(a),i.push($(t).append(u));return i}());return p})}});

